# Story 01.05: Create GitHub Actions CI/CD Pipeline Skeleton

**Epic:** Epic 1 - Foundation Setup
**Story ID:** STORY-01-05
**Priority:** P1 (High)
**Estimated:** 3 hours

---

## Status

**Draft**

---

## Story

**As a** developer,
**I want** GitHub Actions workflows for continuous integration configured for backend and frontend builds,
**so that** code quality is automatically verified on every commit and pull request with build and lint checks.

---

## Acceptance Criteria

1. `.github/workflows/backend-ci.yml` created
2. `.github/workflows/frontend-ci.yml` created
3. Backend workflow builds all .NET projects
4. Frontend workflow builds React app
5. Workflows trigger on push to main and pull requests
6. Build status badge added to README.md
7. Workflows run successfully on GitHub Actions
8. Secrets documented in README for future use

---

## Tasks / Subtasks

- [ ] Create GitHub workflows directory (AC: 1, 2)
  - [ ] Create `.github/workflows/` directory
  - [ ] Verify directory structure correct

- [ ] Create backend CI workflow (AC: 1, 3, 5, 7)
  - [ ] Create `.github/workflows/backend-ci.yml`
  - [ ] Configure trigger: push to main, pull_request
  - [ ] Add job: build-backend
  - [ ] Step: Checkout code (actions/checkout@v4)
  - [ ] Step: Setup .NET 8 SDK (actions/setup-dotnet@v4)
  - [ ] Step: Restore dependencies
  - [ ] Step: Build solution
  - [ ] Step: Run tests (placeholder for future)
  - [ ] Configure runs-on: ubuntu-latest

- [ ] Create frontend CI workflow (AC: 2, 4, 5, 7)
  - [ ] Create `.github/workflows/frontend-ci.yml`
  - [ ] Configure trigger: push to main, pull_request
  - [ ] Add job: build-frontend
  - [ ] Step: Checkout code (actions/checkout@v4)
  - [ ] Step: Setup Node.js 20 (actions/setup-node@v4)
  - [ ] Step: Install dependencies (npm ci)
  - [ ] Step: Lint code (ESLint)
  - [ ] Step: Build application (npm run build)
  - [ ] Step: Run tests (placeholder for future)
  - [ ] Configure runs-on: ubuntu-latest
  - [ ] Configure caching for node_modules

- [ ] Add build status badges (AC: 6)
  - [ ] Update root README.md
  - [ ] Add backend CI badge
  - [ ] Add frontend CI badge
  - [ ] Badges link to workflow runs

- [ ] Document secrets and future enhancements (AC: 8)
  - [ ] Add section to README about GitHub Actions
  - [ ] Document required secrets (none for now)
  - [ ] Document future enhancements (CD, test coverage, etc.)
  - [ ] Add troubleshooting section

- [ ] Test workflows (AC: 7)
  - [ ] Commit and push workflows to GitHub
  - [ ] Verify backend workflow triggers and runs
  - [ ] Verify frontend workflow triggers and runs
  - [ ] Check workflow logs for any errors
  - [ ] Verify both workflows pass

---

## Dev Notes

### Architecture Reference

- **Implementation Plan:** `docs/implementation-plan.md` Section 2, Phase 0
- **Deployment Plan:** `docs/deployment-plan.md` Section 6.4 (CI/CD)

### GitHub Actions Configuration

**Workflow Triggers:**
```yaml
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
```

**Important Notes:**
- Keep workflows simple initially
- Expand with tests in later stories
- Use official GitHub Actions for consistency
- Configure caching to speed up builds

### Backend CI Workflow Template

```yaml
name: Backend CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-backend:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup .NET 8
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '8.0.x'

    - name: Restore dependencies
      run: dotnet restore BudgetCoach.sln

    - name: Build solution
      run: dotnet build BudgetCoach.sln --no-restore --configuration Release

    # Placeholder for future: Unit tests
    # - name: Run tests
    #   run: dotnet test BudgetCoach.sln --no-build --verbosity normal
```

### Frontend CI Workflow Template

```yaml
name: Frontend CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-frontend:
    runs-on: ubuntu-latest

    defaults:
      run:
        working-directory: frontend/web

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup Node.js 20
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'
        cache-dependency-path: frontend/web/package-lock.json

    - name: Install dependencies
      run: npm ci

    - name: Lint code
      run: npm run lint

    - name: Build application
      run: npm run build

    # Placeholder for future: Unit tests
    # - name: Run tests
    #   run: npm test
```

### Build Status Badges

Add to README.md:
```markdown
[![Backend CI](https://github.com/yourusername/ai-budgeting-coach/workflows/Backend%20CI/badge.svg)](https://github.com/yourusername/ai-budgeting-coach/actions?query=workflow%3A%22Backend+CI%22)
[![Frontend CI](https://github.com/yourusername/ai-budgeting-coach/workflows/Frontend%20CI/badge.svg)](https://github.com/yourusername/ai-budgeting-coach/actions?query=workflow%3A%22Frontend+CI%22)
```

### Future Enhancements (Not in This Story)

Document these for later:
- Add unit test execution
- Add integration test execution
- Add test coverage reporting (Codecov)
- Add deployment workflows (CD)
- Add Docker image builds
- Add security scanning (Snyk, CodeQL)
- Add dependency vulnerability scanning
- Matrix builds for multiple platforms

### Workflow Best Practices

1. **Fast Feedback:** Keep workflows fast (< 5 minutes initially)
2. **Caching:** Use caching for dependencies
3. **Fail Fast:** Stop on first error
4. **Clear Names:** Descriptive job and step names
5. **Secrets Management:** Use GitHub Secrets for sensitive data

### Testing

#### Testing Standards

**Test Location:** GitHub Actions (runs automatically on push/PR)

**Manual Verification:**
```bash
# After committing workflows:
# 1. Push to GitHub
git add .github/workflows/
git commit -m "feat: add CI/CD workflows for backend and frontend"
git push origin main

# 2. Check GitHub Actions tab in repository
# 3. Verify both workflows appear
# 4. Verify both workflows run successfully
# 5. Check workflow logs for any warnings
```

**Local Verification (before pushing):**
```bash
# Backend build test (simulates CI)
dotnet restore BudgetCoach.sln
dotnet build BudgetCoach.sln --configuration Release

# Frontend build test (simulates CI)
cd frontend/web
npm ci
npm run lint
npm run build
```

**Expected Workflow Results:**
- ✅ Backend CI: Build completes in ~2-3 minutes
- ✅ Frontend CI: Build completes in ~1-2 minutes
- ✅ Both workflows show green checkmark
- ✅ No errors in workflow logs

**Badge Verification:**
- Badges appear in README.md
- Clicking badge opens workflow runs page
- Badge shows current status (passing/failing)

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-06 | 1.0 | Initial story creation from epic | Winston (Architect) |

---

## Dev Agent Record

### Agent Model Used

_[To be filled by dev agent]_

### Debug Log References

_[To be filled by dev agent]_

### Completion Notes List

_[To be filled by dev agent]_

### File List

_[To be filled by dev agent]_

---

## QA Results

_[To be filled by QA agent after implementation]_
